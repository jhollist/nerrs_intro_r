mutate(bill_ratio = bill_depth/bill_length) %>%
mutate(random_number = rnorm(89))
penguin_ratio
# mutate
penguin_ratio <- penguins %>%
select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(species != "Gentoo") %>%
filter(bill_depth <= 18) %>%
mutate(bill_ratio = bill_depth/bill_length) %>%
mutate(random_number = rnorm(80))
# mutate
penguin_ratio <- penguins %>%
select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(species != "Gentoo") %>%
filter(bill_depth <= 18) %>%
mutate(bill_ratio = bill_depth/bill_length) %>%
mutate(random_number = rnorm(89))
penguin_ratio
# mutate
penguin_ratio <- penguins %>%
select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(species != "Gentoo") %>%
filter(bill_depth <= 18) %>%
mutate(bill_ratio = bill_depth/bill_length) %>%
mutate(random_number = rnorm(89)) %>%
transmute(log_bill_depth = log(bill_depth))
penguin_ratio
?mutate
penguin_case_when <- penguins %>%
select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(species != "Gentoo") %>%
filter(bill_depth <= 18) %>%
mutate(bill_ratio = case_when(species == "Chinstrap" ~
bill_depth/bill_length,
species == "Adelie" ~
bill_length/bill_depth,
TRUE ~ bill_length))
penguin_case_when
View(penguin_case_when)
# group_by and summarize
species_summary <- select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(species != "Gentoo") %>%
filter(bill_depth <= 18) %>%
group_by(species)
penguins %>%
select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(species != "Gentoo") %>%
filter(bill_depth <= 18
)
penguins %>%
select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(species != "Gentoo") %>%
filter(bill_depth <= 18) %>%
group_by(species)
# group_by and summarize
species_summary <- penguins %>%
select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(species != "Gentoo") %>%
filter(bill_depth <= 18) %>%
group_by(species) %>%
summarize(mean_depth = mean(dill_depth),
sd_depth = sd(bill_depth))
# group_by and summarize
species_summary <- penguins %>%
select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(species != "Gentoo") %>%
filter(bill_depth <= 18) %>%
group_by(species) %>%
summarize(mean_depth = mean(bill_depth),
sd_depth = sd(bill_depth))
species_summary
penguin_grouped_mutate <- penguins %>%
group_by(species) %>%
mutate(max_depth = max(bill_depth_mm))
penguin_grouped_mutate
penguin_grouped_mutate <- penguins %>%
group_by(species) %>%
mutate(max_depth = max(bill_depth_mm, na.rm = TRUE))
penguin_grouped_mutate
View(penguin_grouped_mutate)
penguin_grouped_mutate <- penguins %>%
group_by(species) %>%
mutate(mean_depth = mean(bill_depth_mm, na.rm = TRUE)) %>%
ungroup() %>%
mutate(depth_anomaly = dill_depth_mm - mean_depth)
penguin_grouped_mutate <- penguins %>%
group_by(species) %>%
mutate(mean_depth = mean(bill_depth_mm, na.rm = TRUE)) %>%
ungroup() %>%
mutate(depth_anomaly = bill_depth_mm - mean_depth)
penguin_grouped_mutate
penguin_grouped_mutate <- penguins %>%
group_by(species) %>%
mutate(mean_depth = mean(bill_depth_mm, na.rm = TRUE)) %>%
ungroup() %>%
mutate(depth_anomaly = bill_depth_mm - mean_depth) %>%
select(species, mean_depth, depth_anomaly)
penguin_grouped_mutate
penguin_grouped_mutate <- penguins %>%
group_by(species) %>%
mutate(mean_depth = mean(bill_depth_mm, na.rm = TRUE)) %>%
ungroup() %>%
mutate(depth_anomaly = bill_depth_mm - mean_depth) %>%
select(species, mean_depth, depth_anomaly, bill_depth_mm)
penguin_grouped_mutate
# left join
left_table <- data.frame(left_id = 1:6,
names = c("Bob", "Sue", "Jeff", "Alice", "Joe", "Betty"))
right_table <- data.frame(right_id = 1:5,
left_id = c(2,1,3,6,7),
age = c(17,26,45,32,6),
height = c(64, 70, 72.5, 61, 75),
weight = c(125, 175, 210, 120, 235))
left_table
right_table
joined_df <- left_join(left_table, right_table)
joined_df
library(tidyr)
library(dplyr)
# left join
left_table <- data.frame(left_id = 1:6,
names = c("Bob", "Sue", "Jeff", "Alice", "Joe", "Betty"))
right_table <- data.frame(right_id = 1:5,
left_id = c(2,1,3,6,7),
age = c(17,26,45,32,6),
height = c(64, 70, 72.5, 61, 75),
weight = c(125, 175, 210, 120, 235))
left_table
right_table
left_right_table <- left_join(left_table, right_table)
left_right_table
# Pivoting
# Wide to Long format
left_right_table_long <- pivot_longer(data = left_right_table,
cols = c("age", "height", "weight"),
names_to = "parameters",
values_to = "values")
left_right_table_long
# Long to Wide format
left_right_table_wide <- pivot_wider(date = left_right_table_long,
names_from = "paramters",
values_from = "values")
# Long to Wide format
left_right_table_wide <- pivot_wider(date = left_right_table_long,
names_from = "parameters",
values_from = "values")
# Long to Wide format
left_right_table_wide <- pivot_wider(data = left_right_table_long,
names_from = "parameters",
values_from = "values")
left_right_table_wide
library(ggplot2)
library(dplyr)
library(readr)
library(plotly)
library(lubridate)
library(stringr)
library(tidyr)
library(lubridate)
ne_nerrs_sites <- read_csv("https://raw.githubusercontent.com/jhollist/nerrs_r/master/data/ne_nerrs_sites.csv")
ne_nerrs_sites
as_tibble(data.frame(factor("A")))
as_tibble(data.frame(TRUE))
p <- ggplot(data=diamonds, aes(x=price, group=cut, fill=cut)) +
geom_density(adjust=1.5, position="fill") +
theme_ipsum()
library(ggplot2)
p <- ggplot(data=diamonds, aes(x=price, group=cut, fill=cut)) +
geom_density(adjust=1.5, position="fill") +
theme_ipsum()
library(hrbrthemes)
p <- ggplot(data=diamonds, aes(x=price, group=cut, fill=cut)) +
geom_density(adjust=1.5, position="fill") +
theme_ipsum()
p
# Need ggplot2
library(ggplot2)
help(package = "ggplot2")
# Need ggplot2
library(ggplot2)
library(palmerpenguins)
warnings()
install.packages("ggplot2")
ggplot(penguins, aes(x = bill_length_mm, y = bill_depth_mm))
ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
geom_point()
Sys.sleep(1)
system("git add -A")
system("git commit -m `auto commit`")
system("git commit -m 'auto commit'")
system("git add -A")
system('git commit -m "auto commit"')
ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
geom_point() +
geom_smooth(method = "lm")
# NE NERRS Analysis
################################################################################
# Purpose: The purpose of this document is to serve as motivating example (R
# and Open data are cool!), but will also serve to structure the rest of this
# workshop in that we will see how to work with and visualize data in R, combine
# code and documentation with R Markdown, and introduce The Tidyverse
# (https://tidyverse.org) which is an opinionated (but effective) way to think
# about organizing and analyzing data in R.  To accomplish this, we will be
# using data from Wells, Great Bay, Waquoit Bay, and Narragansett Bay National
# Estuarine Research Reserves.  These data provide a nice water quality relevant
# example and you all should be familiar with it to help sort out any issues we
# might run into.
################################################################################
# Install packages, if needed: This is fancier than it normally needs to be.  It
# checks to make sure that packages are installed and installs if they aren't
# then loads it up.
pkgs <- c("ggplot2", "dplyr", "readr", "plotly", "SWMPr")
for(i in pkgs){
if(!i %in% installed.packages()){
install.packages(i)
}
install.packages("lubridate")
################################################################################
# Load up packages in R session
library(ggplot2)
library(dplyr)
library(readr)
library(plotly)
library(lubridate)
library(stringr)
library(tidyr)
library(lubridate)
################################################################################
# Get Data: The data we need is available from the National Aquatic Resource
# Survey's website First we can get the dataset that we have saved as a `.csv`
# in this repository.
ne_nerrs_wq <- read_csv("ne_nerrs_wq_2020.csv", guess_max = 600000)
ne_nerrs_sites <- read_csv("https://raw.githubusercontent.com/jhollist/nerrs_r/master/data/ne_nerrs_sites.csv")
#dim(ne_nerrs_sites) this gives the dimensions
#nrow(ne_nerrs_sites)
################################################################################
# Manipulate Data: Let's tidy up this dataset by dropping all observations with
# a non-zero flag, selecting out our desired columns, and summarizing the data
# for each reserve.
ne_nerrs_wq <- ne_nerrs_wq %>%
select(site, datetimestamp:f_do_pct, ph:f_turb) %>%
mutate(f_temp = case_when(.data$f_temp != 0 ~
NA_real_,
TRUE ~ .data$f_temp),
f_spcond = case_when(.data$f_spcond != 0 ~
NA_real_,
TRUE ~ .data$f_spcond),
f_sal = case_when(.data$f_sal != 0 ~
NA_real_,
TRUE ~ .data$f_sal),
f_do_pct = case_when(.data$f_do_pct != 0 ~
NA_real_,
TRUE ~ .data$f_do_pct),
f_ph = case_when(.data$f_ph != 0 ~
NA_real_,
TRUE ~ .data$f_ph),
f_turb = case_when(.data$f_turb != 0 ~
NA_real_,
TRUE ~ .data$f_turb)) %>%
filter(complete.cases(.)) %>%
select(site, datetimestamp, temp, sal, do_pct, ph, turb) %>%
mutate(reserve = str_sub(site, 1, 3),
datetime = ymd_hms(datetimestamp),
year = year(datetime),
month = month(datetime),
day = day(datetime),
date = ymd(paste(year, month, day, "-"))) %>%
select(reserve, site, date, temp, sal, do_pct, ph, turb) %>%
gather("param", "measurement", temp:turb) %>%
group_by(reserve, date, param) %>%
summarize(measurement = mean(measurement, na.rm = TRUE))
ne_nerrs_wq
# cleaning up ne_nerrs_wq
ne_nerrs_wq_sites <- ne_nerrs_sites %>%
select(reserve = nerr_site_id, latitude, longitude, reserve_name) %>%
filter(reserve == "grb" | reserve == "nar" | reserve == "wel" | reserve == "wqb") %>%
group_by(reserve) %>%
summarize(lat_mean = mean(latitude, na.rm = TRUE),
long_mean = mean(longitude, na.rm = TRUE)) %>%
left_join(ne_nerrs_wq)
# cleaning up ne_nerrs_wq
ne_nerrs_wq_sites <- ne_nerrs_sites %>%
select(reserve = nerr_site_id, latitude, longitude, reserve_name) %>%
filter(reserve == "grb" | reserve == "nar" | reserve == "wel" | reserve == "wqb") %>%
group_by(reserve) %>%
summarize(lat_mean = mean(latitude, na.rm = TRUE),
long_mean = mean(longitude, na.rm = TRUE)) %>%
ungroup() %>%
left_join(ne_nerrs_wq)
ne_nerrs_wq_sites
# cleaning up ne_nerrs_wq
ne_nerrs_wq_sites <- ne_nerrs_sites %>%
select(reserve = nerr_site_id, latitude, longitude, reserve_name) %>%
filter(reserve == "grb" | reserve == "nar" | reserve == "wel" | reserve == "wqb") %>%
group_by(reserve) %>%
summarize(lat_mean = mean(latitude, na.rm = TRUE),
long_mean = mean(longitude, na.rm = TRUE)) %>%
ungroup() %>%
left_join(ne_nerrs_wq) %>%
pivot_wider(names_from = param, values_from = measurement)
ne_nerrs_wq_sites
ne_nerrs_sites %>%
select(reserve = nerr_site_id, latitude, longitude, reserve_name) %>%
filter(reserve == "grb" | reserve == "nar" | reserve ==  "wel" |
reserve ==  "wqb") %>%
group_by(reserve) %>%
summarize(lat_mean = mean(latitude, na.rm = TRUE),
long_mean = mean(longitude, na.rm = TRUE))
ne_nerrs_sites %>%
select(reserve = nerr_site_id, latitude, longitude, reserve_name) %>%
filter(reserve == "grb" | reserve == "nar" | reserve ==  "wel" |
reserve ==  "wqb") %>%
group_by(reserve) %>%
summarize(lat_mean = mean(latitude, na.rm = TRUE),
long_mean = mean(longitude, na.rm = TRUE)) %>%
left_join(ne_nerrs_wq, by = "reserve")
ne_nerrs_wq_sites <- ne_nerrs_sites %>%
select(reserve = nerr_site_id, latitude, longitude, reserve_name) %>%
filter(reserve == "grb" | reserve == "nar" | reserve ==  "wel" |
reserve ==  "wqb") %>%
group_by(reserve) %>%
summarize(lat_mean = mean(latitude, na.rm = TRUE),
long_mean = mean(longitude, na.rm = TRUE)) %>%
left_join(ne_nerrs_wq, by = "reserve") %>%
pivot_wider(names_from = param, values_from = measurement)
ne_nerrs_wq_sites
ne_nerrs_wq_sites_1 <- ne_nerrs_sites %>%
select(reserve = nerr_site_id, latitude, longitude, reserve_name)
ne_nerrs_wq_sites_2  <- ne_nerrs_wq_sites_1 %>%
filter(reserve == "grb" | reserve == "nar" | reserve ==  "wel" |
reserve ==  "wqb")
ne_nerrs_wq_sites <- ne_nerrs_sites_2 %>%
group_by(reserve) %>%
summarize(lat_mean = mean(latitude, na.rm = TRUE),
long_mean = mean(longitude, na.rm = TRUE)) %>%
left_join(ne_nerrs_wq, by = "reserve") %>%
pivot_wider(names_from = param, values_from = measurement)
ne_nerrs_wq_sites <- ne_nerrs_wq_sites_2 %>%
group_by(reserve) %>%
summarize(lat_mean = mean(latitude, na.rm = TRUE),
long_mean = mean(longitude, na.rm = TRUE)) %>%
left_join(ne_nerrs_wq, by = "reserve") %>%
pivot_wider(names_from = param, values_from = measurement)
ls()
ls(pattern = "ne_nerrs_wq_sites_")
rm(list = ls(pattern = "ne_nerrs_wq_sites_"))
View(ne_nerrs_sites)
rm(ne_nerrs_wq_sites)
ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm))
# Need ggplot2
library(ggplot2)
library(palmerpenguins)
ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm))
ne_nerrs_wq
penguins
penguin_gg <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
geom_point()
penguin_gg
penguin_gg <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
geom_point() +
labs(x = "Bill Length (mm)", y = "Bill Depth (mm)")
penguin_gg
penguin_gg <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
geom_point() +
labs(x = "Bill Length (mm)", y = "Bill Depth (mm)",
title = "Association Between Penguin Bill Measurements")
penguin_gg
penguin_gg <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
geom_point(aes(color = "species", shape = "species"), size = 2) +
labs(x = "Bill Length (mm)", y = "Bill Depth (mm)",
title = "Association Between Penguin Bill Measurements")
penguin_gg
penguin_gg <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
geom_point(aes(color = species, shape = species), size = 2) +
labs(x = "Bill Length (mm)", y = "Bill Depth (mm)",
title = "Association Between Penguin Bill Measurements")
penguin_gg
penguins
penguin_gg <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
geom_point(aes(color = species, shape = species), size = 8) +
labs(x = "Bill Length (mm)", y = "Bill Depth (mm)",
title = "Association Between Penguin Bill Measurements")
penguin_gg
penguin_gg <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
geom_point(aes(color = species, shape = species), size = 2) +
labs(x = "Bill Length (mm)", y = "Bill Depth (mm)",
title = "Association Between Penguin Bill Measurements")
penguin_gg
penguin_gg <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
geom_point(aes(color = species, shape = species), size = 2) +
labs(x = "Bill Length (mm)", y = "Bill Depth (mm)",
title = "Association Between Penguin Bill Measurements") +
geom_smooth(method = "loess")
penguin_gg
?lm
penguin_gg <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
geom_point(aes(color = species, shape = species), size = 2) +
labs(x = "Bill Length (mm)", y = "Bill Depth (mm)",
title = "Association Between Penguin Bill Measurements") +
geom_smooth(method = "lm")
penguin_gg
penguin_gg <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
geom_point(aes(color = species, shape = species), size = 2) +
labs(x = "Bill Length (mm)", y = "Bill Depth (mm)",
title = "Association Between Penguin Bill Measurements") +
geom_smooth(aes(color = species), method = "lm")
penguin_gg
penguin_gg <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
geom_point(aes(color = species, shape = species), size = 2) +
labs(x = "Bill Length (mm)", y = "Bill Depth (mm)",
title = "Association Between Penguin Bill Measurements") +
geom_smooth(aes(species), method = "lm")
penguin_gg
?aes
penguin_gg <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
geom_point(aes(color = species, shape = species), size = 2) +
labs(x = "Bill Length (mm)", y = "Bill Depth (mm)",
title = "Association Between Penguin Bill Measurements") +
geom_smooth(aes(group = species), method = "lm")
penguin_gg
penguin_gg <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
geom_point(aes(color = species, shape = species), size = 2) +
labs(x = "Bill Length (mm)", y = "Bill Depth (mm)",
title = "Association Between Penguin Bill Measurements") +
geom_smooth(aes(color = species), method = "lm")
penguin_gg
penguin_gg <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm,
color = species)) +
geom_point(size = 2) +
labs(x = "Bill Length (mm)", y = "Bill Depth (mm)",
title = "Association Between Penguin Bill Measurements") +
geom_smooth(method = "lm")
penguin_gg
penguin_gg <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm,
color = species)) +
geom_point(aes(shape = species), size = 2) +
labs(x = "Bill Length (mm)", y = "Bill Depth (mm)",
title = "Association Between Penguin Bill Measurements") +
geom_smooth(method = "lm")
penguin_gg
penguin_gg <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm,
color = species)) +
geom_point(aes(shape = species), size = 2) +
labs(x = "Bill Length (mm)", y = "Bill Depth (mm)",
title = "Association Between Penguin Bill Measurements") +
geom_smooth(aes(group = species), method = "lm")
penguin_gg
penguin_gg <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
geom_point(aes(shape = species), size = 2) +
labs(x = "Bill Length (mm)", y = "Bill Depth (mm)",
title = "Association Between Penguin Bill Measurements") +
geom_smooth(aes(group = species), method = "lm")
penguin_gg
penguin_gg <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
geom_point(aes(color = species, shape = species), size = 2) +
labs(x = "Bill Length (mm)", y = "Bill Depth (mm)",
title = "Association Between Penguin Bill Measurements") +
geom_smooth(aes(group = species), method = "lm")
penguin_gg
penguin_gg <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
geom_point(size = 2) +
labs(x = "Bill Length (mm)", y = "Bill Depth (mm)",
title = "Association Between Penguin Bill Measurements") +
geom_smooth(aes(group = species), method = "lm")
penguin_gg
penguin_gg <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
geom_point(aes(color = species, shape = species), size = 2) +
labs(x = "Bill Length (mm)", y = "Bill Depth (mm)",
title = "Association Between Penguin Bill Measurements") +
geom_smooth(aes(group = species), method = "lm")
penguin_gg
penguin_gg <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
geom_point(aes(color = species, shape = species), size = 2) +
labs(x = "Bill Length (mm)", y = "Bill Depth (mm)",
title = "Association Between Penguin Bill Measurements") +
geom_smooth(aes(group = species), method = "lm") +
theme_minimal()
penguin_gg
install.packages("ggthemes")
library(ggthemes)
penguin_gg <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
geom_point(aes(color = species, shape = species), size = 2) +
labs(x = "Bill Length (mm)", y = "Bill Depth (mm)",
title = "Association Between Penguin Bill Measurements") +
geom_smooth(aes(group = species), method = "lm") +
theme_base()
penguin_gg
penguin_gg <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
geom_point(aes(color = species, shape = species), size = 2) +
labs(x = "Bill Length (mm)", y = "Bill Depth (mm)",
title = "Association Between Penguin Bill Measurements") +
geom_smooth(aes(group = species), method = "lm") +
theme_tufte()
penguin_gg
penguin_gg <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
geom_point(aes(color = species, shape = species), size = 2) +
labs(x = "Bill Length (mm)", y = "Bill Depth (mm)",
title = "Association Between Penguin Bill Measurements") +
geom_smooth(aes(group = species), method = "lm") +
theme_minimal()
penguin_gg
penguin_gg <- ggplot(data = penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +
geom_point(aes(color = species, shape = species), size = 2) +
labs(x = "Bill Length (mm)", y = "Bill Depth (mm)",
title = "Association Between Penguin Bill Measurements") +
geom_smooth(aes(group = species), method = "lm") +
theme_minimal()
penguin_gg
ggsave("penguin_plot.tif", penguin_gg, dpi = 600)
ggsave("penguin_plot.jpg", penguin_gg, dpi = 600)
ggsave("penguin_plot.jpg", penguin_gg, dpi = 600, units = "in", width = 8.5,
height = 11)
