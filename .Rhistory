filter(reserve == "grb" | reserve == "nar" | reserve == "wel" | reserve == "wqb")
ne_nerrs_sites <- read_csv("https://raw.githubusercontent.com/jhollist/nerrs_r/master/data/ne_nerrs_sites.csv")
ne_nerrs_sites <- read_csv("https://raw.githubusercontent.com/jhollist/nerrs_r/master/data/ne_nerrs_sites.csv", guess_max = 100)
ne_nerrs_sites <- read_csv("https://raw.githubusercontent.com/jhollist/nerrs_r/master/data/ne_nerrs_sites.csv")
# cleaning up ne_nerrs_wq
ne_nerrs_wq_sites <- ne_nerrs_sites %>%
select(reserve = nerr_site_id, reserve_name, station_name, latitude, longitude) %>%
filter(reserve == "grb" | reserve == "nar" | reserve == "wel" | reserve == "wqb") %>%
group_by(reserve, reserve_name) %>%
summarize(lat_mean = mean(latitude),
long_mean = mean(longitude)) %>%
left_join(ne_nerrs_wq)
View(ne_nerrs_wq_sites)
library(tidyr)
?pivot_wider
pivot_wider(ne_nerrs_wq_sites, names_from = param, values_from = measurement)
ne_nerrs_wq_sites %>%
pivot_wider(names_from = param, values_from = measurement) %>%
ggplot(aes(x = do_pct, y = ph)) +
geom_point()
ne_nerrs_wq_sites %>%
pivot_wider(names_from = param, values_from = measurement) %>%
select(do_pct:turb) %>%
plot()
# cleaning up ne_nerrs_wq
ne_nerrs_wq_sites <- ne_nerrs_sites %>%
select(reserve = nerr_site_id, reserve_name, station_name, latitude, longitude) %>%
filter(reserve == "grb" | reserve == "nar" | reserve == "wel" | reserve == "wqb") %>%
group_by(reserve, reserve_name) %>%
summarize(lat_mean = mean(latitude),
long_mean = mean(longitude)) %>%
ungroup() %>%
left_join(ne_nerrs_wq)
ne_nerrs_wq_sites %>%
pivot_wider(names_from = param, values_from = measurement) %>%
select(do_pct:turb) %>%
plot()
ne_nerrs_wq_sites %>%
pivot_wider(names_from = param, values_from = measurement) %>%
ggplot(aes(x = do_pct, y = ph)) +
geom_point(aes(color = reserve))
ne_nerrs_wq_sites
# cleaning up ne_nerrs_wq
ne_nerrs_wq_sites <- ne_nerrs_sites %>%
select(reserve = nerr_site_id, reserve_name, station_name, latitude, longitude) %>%
filter(reserve == "grb" | reserve == "nar" | reserve == "wel" | reserve == "wqb") %>%
group_by(reserve, reserve_name) %>%
summarize(lat_mean = mean(latitude),
long_mean = mean(longitude)) %>%
ungroup() %>%
left_join(ne_nerrs_wq) %>%
pivot_wider(names_from = param,
values_from = measurement)
ne_nerrs_wq_sites
ne_nerrs_wq_sites %>%
ggplot(aes(x = do_pct, y = ph)) +
geom_point(aes(color = reserve)) +
theme_classic() +
labs(x = "Dissolved Oxygen (%)", y = "pH", title = "Association between dissolved oxygen and pH, by reserve")
ne_nerrs_wq_sites %>%
ggplot(aes(x = do_pct, y = ph)) +
geom_point(aes(color = reserve_name, size = temp)) +
theme_classic() +
labs(x = "Dissolved Oxygen (%)", y = "pH", title = "Association between dissolved oxygen and pH, by reserve")
ne_nerrs_wq_sites %>%
ggplot(aes(x = do_pct, y = ph)) +
geom_point(aes(color = reserve_name, size = sal)) +
theme_classic() +
labs(x = "Dissolved Oxygen (%)", y = "pH", title = "Association between dissolved oxygen and pH, by reserve")
ne_nerrs_wq_sites %>%
ggplot(aes(x = ph, y = do_pct)) +
geom_point(aes(color = reserve_name)) +
theme_classic() +
labs(x = "Dissolved Oxygen (%)", y = "pH", title = "Association between dissolved oxygen and pH, by reserve")
ne_nerrs_wq_sites %>%
ggplot(aes(x = ph, y = do_pct)) +
geom_point(aes(color = reserve_name)) +
theme_classic() +
labs(y = "Dissolved Oxygen (%)", x = "pH", title = "Association between dissolved oxygen and pH, by reserve")
?paste()
?paste
72.76/2
library(USAboundaries)
library(sf)
library(dplyr)
library(elevatr)
library(raster)
# Get map of lower 48 states
usa_l48 <- us_boundaries() %>%
filter(state_abbr != "HI" &
state_abbr != "AK" &
state_abbr != "PR")
# Get DEM.  Zoom level 4 returns dem of ~ 3.8km resolution for whole of lower 48
usa_l48_dem <- get_elev_raster(as(usa_l48, "Spatial"), src="aws", z = 4, clip = "location")
# Project to albers/meters
usgs_albers <- "+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=37.5 +lon_0=-96 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs"
usa_l48_alb <- usa_l48 %>%
st_transform(crs = usgs_albers)
usa_l48_dem_alb <- projectRaster(usa_l48_dem, crs = usgs_albers)
# Plot it
plot(usa_l48_dem_alb)
plot(st_geometry(usa_l48_alb), fill = F,  add = T)
install.packages("USAboundaries")
library(USAboundaries)
library(sf)
library(dplyr)
library(elevatr)
library(raster)
# Get map of lower 48 states
usa_l48 <- us_boundaries() %>%
filter(state_abbr != "HI" &
state_abbr != "AK" &
state_abbr != "PR")
# Get DEM.  Zoom level 4 returns dem of ~ 3.8km resolution for whole of lower 48
usa_l48_dem <- get_elev_raster(as(usa_l48, "Spatial"), src="aws", z = 4, clip = "location")
# Project to albers/meters
usgs_albers <- "+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=37.5 +lon_0=-96 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs"
usa_l48_alb <- usa_l48 %>%
st_transform(crs = usgs_albers)
usa_l48_dem_alb <- projectRaster(usa_l48_dem, crs = usgs_albers)
# Plot it
plot(usa_l48_dem_alb)
plot(st_geometry(usa_l48_alb), fill = F,  add = T)
library(USAboundaries)
library(sf)
library(dplyr)
library(elevatr)
library(raster)
# Get map of lower 48 states
usa_l48 <- us_boundaries() %>%
filter(state_abbr != "HI" &
state_abbr != "AK" &
state_abbr != "PR")
# Get DEM.  Zoom level 4 returns dem of ~ 3.8km resolution for whole of lower 48
usa_l48_dem <- get_elev_raster(as(usa_l48, "Spatial"), src="aws", z = 6, clip = "location")
# Project to albers/meters
usgs_albers <- "+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=37.5 +lon_0=-96 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs"
usa_l48_alb <- usa_l48 %>%
st_transform(crs = usgs_albers)
usa_l48_dem_alb <- projectRaster(usa_l48_dem, crs = usgs_albers)
# Plot it
plot(usa_l48_dem_alb)
plot(st_geometry(usa_l48_alb), fill = F,  add = T)
library(readxl)
ne_nerrs_wq_excel <- read_excel("ne_nerrs_wq_2020.xlsx", guess_max = 600000)
View(ne_nerrs_wq_excel)
library(ggplot2)
library(dplyr)
library(readr)
library(plotly)
library(lubridate)
library(stringr)
library(tidyr)
ne_nerrs_wq <- read_csv("ne_nerrs_wq_2020.csv", guess_max = 600000)
install.packages("lubridate")
library(lubridate)
?lubridate
help(package = "lubridate")
examp_df <- data.frame(col_1 = c(1,2,3), col_2 = c("a", "b", "c"))
examp_df
View(examp_df)
install.packages("readxl")
library(readxl)
# Reading in data from excel
# Don't forget to install readxl package
libary(readxl)
# Reading in data from excel
# Don't forget to install readxl package
library(readxl)
ne_nerrs_2020_xl <- read_excel("ne_nerrs_wq_2020.xlsx", guess_max = 600000)
?read_excel
ne_nerrs_2020 <- read_csv("ne_nerrs_wq_2020.csv")
ne_nerrs_2020 <- read_csv("ne_nerrs_wq_2020.csv", guess_max = 656033)
read.cv("Book1.csv")
read.csv("Book1.csv")
data.frame("weight(kg)" = 1)
data.frame("weight\(kg\)" = 1)
data.frame("weight\\(kg\\)" = 1)
library(ggplot2)
library(dplyr)
library(readr)
library(plotly)
library(lubridate)
library(stringr)
library(tidyr)
library(lubridate)
ne_nerrs_wq <- read_csv("ne_nerrs_wq_2020.csv", guess_max = 600000)
ne_nerrs_sites <- read_csv("https://raw.githubusercontent.com/jhollist/nerrs_r/master/data/ne_nerrs_sites.csv")
dim(ne_nerrs_sites)
# Selecting columns
library(palmerpenguins)
View(palmerpenguins)
View(penguins)
library(dplyr)
penguin_bill <- select(penguins, bill_depth_mm, bill_length_mm)
penguin_bill
penguin_bill_piped <- penguins %>% select(bill_depth_mm, bill_length_mm)
penguin_bill_piped
penguin_bill_gentoo_adelie <- penguins %>%
select(species, bill_depth_mm, bill_length_mm) %>%
filter(species = "Gentoo" | species == "Adelie")
penguin_bill_gentoo_adelie <- penguins %>%
select(species, bill_depth_mm, bill_length_mm) %>%
filter(species == "Gentoo" | species == "Adelie")
penguin_bill_gentoo_adelie
View(penguin_bill_gentoo_adelie)
penguin_bill_gentoo_adelie <- penguins %>%
select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(species == "Gentoo" | species == "Adelie")
penguin_bill_gentoo_adelie
penguin_bill_gentoo_adelie <- penguins %>%
select(bill_depth = bill_depth_mm, bill_length = bill_length_mm, species) %>%
filter(species == "Gentoo" | species == "Adelie")
penguin_bill_gentoo_adelie
penguin_bill_gentoo_adelie <- penguins %>%
select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(species == "Gentoo" | species == "Adelie" & bill_depth <= 18)
penguin_bill_gentoo_adelie
# Filtering rows
idx <- penguins$species != "Gentoo"
idx
penguin_bill_gentoo_adelie <- penguins %>%
select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(idx) %>%
filter(bill_depth <= 18)
penguin_bill_gentoo_adelie
View(penguin_bill_gentoo_adelie)
|>
\(x) print(x)
function(x) print(x)
17/175
0.097*100
234.2/500
0.4684*100
ne_nerrs_wq <- read_csv("ne_nerrs_wq_2020.csv", guess_max = 600000)
library(ggplot2)
library(dplyr)
library(readr)
library(plotly)
library(lubridate)
library(stringr)
library(tidyr)
library(lubridate)
ne_nerrs_wq <- read_csv("ne_nerrs_wq_2020.csv", guess_max = 600000)
ne_nerrs_sites <- read_csv("https://raw.githubusercontent.com/jhollist/nerrs_r/master/data/ne_nerrs_sites.csv")
table(ne_nerrs_sites$reserve_name)
ne_nerrs_wq <- ne_nerrs_wq %>%
select(site, datetimestamp:f_do_pct, ph:f_turb) %>%
mutate(f_temp = case_when(.data$f_temp != 0 ~
NA_real_,
TRUE ~ .data$f_temp),
f_spcond = case_when(.data$f_spcond != 0 ~
NA_real_,
TRUE ~ .data$f_spcond),
f_sal = case_when(.data$f_sal != 0 ~
NA_real_,
TRUE ~ .data$f_sal),
f_do_pct = case_when(.data$f_do_pct != 0 ~
NA_real_,
TRUE ~ .data$f_do_pct),
f_ph = case_when(.data$f_ph != 0 ~
NA_real_,
TRUE ~ .data$f_ph),
f_turb = case_when(.data$f_turb != 0 ~
NA_real_,
TRUE ~ .data$f_turb)) %>%
filter(complete.cases(.)) %>%
select(site, datetimestamp, temp, sal, do_pct, ph, turb) %>%
mutate(reserve = str_sub(site, 1, 3),
datetime = ymd_hms(datetimestamp),
year = year(datetime),
month = month(datetime),
day = day(datetime),
date = ymd(paste(year, month, day, "-"))) %>%
select(reserve, site, date, temp, sal, do_pct, ph, turb) %>%
gather("param", "measurement", temp:turb) %>%
group_by(reserve, date, param) %>%
summarize(measurement = mean(measurement, na.rm = TRUE))
# cleaning up ne_nerrs_wq
ne_nerrs_wq_sites <- ne_nerrs_sites %>%
select(reserve = nerr_site_id, reserve_name, station_name, latitude, longitude) %>%
filter(reserve == "grb" | reserve == "nar" | reserve == "wel" | reserve == "wqb") %>%
group_by(reserve, reserve_name) %>%
summarize(lat_mean = mean(latitude, na.rm = TRUE),
long_mean = mean(longitude, na.rm = TRUE)) %>%
left_join(ne_nerrs_wq)
table(ne_nerrs_wq_sites$reserve_name)
library(palmerpenguins)
library(dplyr)
penguins
penguin_bill <- select(penguins, bill_depth_mm, bill_length_mm)
penguin_bill
# Filtering rows
idx <- penguins$
penguin_bill_gentoo_adelie <- penguins %>%
select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(species != "Gentoo") %>%
filter(bill_depth <= 18)
penguin_bill_gentoo_adelie <- penguins %>%
select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm)
penguin_bill_gentoo_adelie <- penguins %>%
select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(species != "Gentoo")
penguin_bill_gentoo_adelie <- penguins %>%
select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(species != "Gentoo") %>%
filter(bill_depth <= 18)
penguin_bill_gentoo_adelie <- penguins %>%
select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(species != "Gentoo") %>%
filter(bill_depth <= 18)
penguin_bill_gentoo_adelie
View(penguin_bill_gentoo_adelie)
# Start next week with pipe and pipe alternatives
# Intermediate steps
p1 <- select(penguins, species, bill_depth = bill_depth_mm, bill_length = bill_length_mm)
p2 <- filter(p1, species != "Gentoo")
p3 <- filter(p2, bill_depth <= 18)
p3
penguin_bill_gentoo_adelie
# Nested function
p_nested <- select(filter(filter(penguins, bill_depth <= 18),
species != "Gentoo"),
species, bill_depth = bill_depth_mm, bill_length = bill_length_mm)
filter(penguins, bill_depth <= 18)
# Nested function
p_nested <- select(filter(filter(penguins, bill_depth_mm <= 18),
species != "Gentoo"),
species, bill_depth = bill_depth_mm, bill_length = bill_length_mm)
p_nested
p1
p3
random_numbers <- rnorm(100)
mean(random_numbers)
mean_rand <- mean(rnorm(100))
# mutate
penguin_ratio <- penguins %>%
select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(species != "Gentoo") %>%
filter(bill_depth <= 18) %>%
mutate(bill_ratio = bill_depth/bill_length)
penguin_ratio
17.4/39.5
View(penguin_ratio)
# mutate
penguin_ratio <- penguins %>%
select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(species != "Gentoo") %>%
filter(bill_depth <= 18) %>%
mutate(bill_ratio = bill_depth/bill_length) %>%
mutate(random_number = rnorm(89))
penguin_ratio
# mutate
penguin_ratio <- penguins %>%
select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(species != "Gentoo") %>%
filter(bill_depth <= 18) %>%
mutate(bill_ratio = bill_depth/bill_length) %>%
mutate(random_number = rnorm(80))
# mutate
penguin_ratio <- penguins %>%
select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(species != "Gentoo") %>%
filter(bill_depth <= 18) %>%
mutate(bill_ratio = bill_depth/bill_length) %>%
mutate(random_number = rnorm(89))
penguin_ratio
# mutate
penguin_ratio <- penguins %>%
select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(species != "Gentoo") %>%
filter(bill_depth <= 18) %>%
mutate(bill_ratio = bill_depth/bill_length) %>%
mutate(random_number = rnorm(89)) %>%
transmute(log_bill_depth = log(bill_depth))
penguin_ratio
?mutate
penguin_case_when <- penguins %>%
select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(species != "Gentoo") %>%
filter(bill_depth <= 18) %>%
mutate(bill_ratio = case_when(species == "Chinstrap" ~
bill_depth/bill_length,
species == "Adelie" ~
bill_length/bill_depth,
TRUE ~ bill_length))
penguin_case_when
View(penguin_case_when)
# group_by and summarize
species_summary <- select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(species != "Gentoo") %>%
filter(bill_depth <= 18) %>%
group_by(species)
penguins %>%
select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(species != "Gentoo") %>%
filter(bill_depth <= 18
)
penguins %>%
select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(species != "Gentoo") %>%
filter(bill_depth <= 18) %>%
group_by(species)
# group_by and summarize
species_summary <- penguins %>%
select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(species != "Gentoo") %>%
filter(bill_depth <= 18) %>%
group_by(species) %>%
summarize(mean_depth = mean(dill_depth),
sd_depth = sd(bill_depth))
# group_by and summarize
species_summary <- penguins %>%
select(species, bill_depth = bill_depth_mm, bill_length = bill_length_mm) %>%
filter(species != "Gentoo") %>%
filter(bill_depth <= 18) %>%
group_by(species) %>%
summarize(mean_depth = mean(bill_depth),
sd_depth = sd(bill_depth))
species_summary
penguin_grouped_mutate <- penguins %>%
group_by(species) %>%
mutate(max_depth = max(bill_depth_mm))
penguin_grouped_mutate
penguin_grouped_mutate <- penguins %>%
group_by(species) %>%
mutate(max_depth = max(bill_depth_mm, na.rm = TRUE))
penguin_grouped_mutate
View(penguin_grouped_mutate)
penguin_grouped_mutate <- penguins %>%
group_by(species) %>%
mutate(mean_depth = mean(bill_depth_mm, na.rm = TRUE)) %>%
ungroup() %>%
mutate(depth_anomaly = dill_depth_mm - mean_depth)
penguin_grouped_mutate <- penguins %>%
group_by(species) %>%
mutate(mean_depth = mean(bill_depth_mm, na.rm = TRUE)) %>%
ungroup() %>%
mutate(depth_anomaly = bill_depth_mm - mean_depth)
penguin_grouped_mutate
penguin_grouped_mutate <- penguins %>%
group_by(species) %>%
mutate(mean_depth = mean(bill_depth_mm, na.rm = TRUE)) %>%
ungroup() %>%
mutate(depth_anomaly = bill_depth_mm - mean_depth) %>%
select(species, mean_depth, depth_anomaly)
penguin_grouped_mutate
penguin_grouped_mutate <- penguins %>%
group_by(species) %>%
mutate(mean_depth = mean(bill_depth_mm, na.rm = TRUE)) %>%
ungroup() %>%
mutate(depth_anomaly = bill_depth_mm - mean_depth) %>%
select(species, mean_depth, depth_anomaly, bill_depth_mm)
penguin_grouped_mutate
# left join
left_table <- data.frame(left_id = 1:6,
names = c("Bob", "Sue", "Jeff", "Alice", "Joe", "Betty"))
right_table <- data.frame(right_id = 1:5,
left_id = c(2,1,3,6,7),
age = c(17,26,45,32,6),
height = c(64, 70, 72.5, 61, 75),
weight = c(125, 175, 210, 120, 235))
left_table
right_table
joined_df <- left_join(left_table, right_table)
joined_df
library(tidyr)
library(dplyr)
# left join
left_table <- data.frame(left_id = 1:6,
names = c("Bob", "Sue", "Jeff", "Alice", "Joe", "Betty"))
right_table <- data.frame(right_id = 1:5,
left_id = c(2,1,3,6,7),
age = c(17,26,45,32,6),
height = c(64, 70, 72.5, 61, 75),
weight = c(125, 175, 210, 120, 235))
left_table
right_table
left_right_table <- left_join(left_table, right_table)
left_right_table
# Pivoting
# Wide to Long format
left_right_table_long <- pivot_longer(data = left_right_table,
cols = c("age", "height", "weight"),
names_to = "parameters",
values_to = "values")
left_right_table_long
# Long to Wide format
left_right_table_wide <- pivot_wider(date = left_right_table_long,
names_from = "paramters",
values_from = "values")
# Long to Wide format
left_right_table_wide <- pivot_wider(date = left_right_table_long,
names_from = "parameters",
values_from = "values")
# Long to Wide format
left_right_table_wide <- pivot_wider(data = left_right_table_long,
names_from = "parameters",
values_from = "values")
left_right_table_wide
library(ggplot2)
library(dplyr)
library(readr)
library(plotly)
library(lubridate)
library(stringr)
library(tidyr)
library(lubridate)
ne_nerrs_sites <- read_csv("https://raw.githubusercontent.com/jhollist/nerrs_r/master/data/ne_nerrs_sites.csv")
ne_nerrs_sites
as_tibble(data.frame(factor("A")))
as_tibble(data.frame(TRUE))
